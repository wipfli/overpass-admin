(this["webpackJsonpoverpass-admin"]=this["webpackJsonpoverpass-admin"]||[]).push([[0],{125:function(e,t,n){"use strict";n.r(t);var o=n(0),i=n(11),c=n.n(i),a=n(14),r=n(55),l=n.n(r),s=(n(98),n(165)),d=n(40),u=n(76),j=n.n(u),p=n(77),b=n.n(p),y=n(174),h=n(166),f=n(163),O=n(7),m=function(e){var t=e.viewportWidth,n=e.viewportHeight,i=e.centerLongitude,c=e.centerLatitude,r=e.shareMap,u=window.location.hash.split("/"),p=Object(a.a)(u,5),m=(p[1],p[2]),v=p[3],g=p[4],x=Object(o.useState)(g?Number(g):7),w=Object(a.a)(x,2),S=w[0],k=w[1],C=Object(o.useState)(null),L=Object(a.a)(C,2),E=L[0],H=L[1],W=Object(o.useRef)(null),z=Object(o.useState)({lng:m?Number(m):i,lat:v?Number(v):c}),F=Object(a.a)(z,2),M=F[0],Z=F[1];return Object(o.useEffect)((function(){var e=new l.a.Map({container:W.current,style:"https://vectortiles.geo.admin.ch/styles/ch.swisstopo.leichte-basiskarte.vt/style.json",center:M,zoom:S,attributionControl:!1}),t=new l.a.ScaleControl({maxWidth:80,unit:"metric"});e.addControl(t),e.dragRotate.disable(),e.touchZoomRotate.disableRotation(),e.on("move",(function(){Z(e.getCenter()),k(e.getZoom())})),e.on("load",(function(){e.resize()})),H(e),r(e)}),[]),Object(o.useEffect)((function(){E&&E.resize()}),[t,n]),Object(o.useEffect)((function(){var e=window.location.hash.split("/"),t=Object(a.a)(e,2)[1],n="#/".concat(t,"/").concat(M.lng.toFixed(6),"/").concat(M.lat.toFixed(6),"/").concat(S.toFixed(1),"/");window.history.replaceState(void 0,void 0,n)}),[M,S]),Object(O.jsxs)("div",{children:[Object(O.jsx)("div",{ref:W,style:{position:"absolute",left:0,top:0,bottom:0,right:0}}),Object(O.jsx)("div",{style:{position:"absolute",right:0,top:0,padding:10},children:Object(O.jsxs)(y.a,{display:"flex",flexDirection:"column",children:[Object(O.jsx)(f.a,{title:"Zoom In",placement:"left",children:Object(O.jsx)(s.a,{onClick:function(){E&&(E.setZoom(S+1),k(S+1))},children:Object(O.jsx)(j.a,{})})}),Object(O.jsx)(f.a,{title:"Zoom Out",placement:"left",children:Object(O.jsx)(s.a,{onClick:function(){E&&(E.setZoom(S-1),k(S-1))},children:Object(O.jsx)(b.a,{})})})]})}),Object(O.jsx)("div",{style:{position:"absolute",right:0,bottom:0},children:Object(O.jsx)(y.a,{display:"flex",justifyContent:"flex-end",mx:1,color:"text.secondary",children:Object(O.jsx)(d.a,{style:{fontSize:12},children:Object(O.jsx)(h.a,{color:"inherit",href:"https://www.geo.admin.ch/",children:"\xa9swisstopo "})})})})]})},v=n(58),g=n(56),x=n.n(g),w=n(169),S=n(167),k=n(168),C=n(170),L=n(171),E=n(57),H=n.n(E),W=n(176),z=n(172),F=n(175),M=function(e){var t=e.map,n=e.viewportHeight,i=e.viewportWidth,c=Object(o.useState)("loading..."),r=Object(a.a)(c,2),l=r[0],d=r[1],u=Object(o.useState)(["loading..."]),j=Object(a.a)(u,2),p=j[0],b=j[1],h=Object(o.useState)(null),f=Object(a.a)(h,2),m=f[0],g=f[1],E=Object(o.useState)(null),M=Object(a.a)(E,2),Z=M[0],B=M[1];Object(o.useEffect)((function(){x.a.get("https://api3.geo.admin.ch/rest/services/api/MapServer").then((function(e){var t=e.data.layers.map((function(e){return e.layerBodId})).sort();b(t),d(t[0])})).catch((function(e){return console.log(e)}))}),[]),Object(o.useEffect)((function(){var e=window.location.hash.split("/"),n=Object(a.a)(e,2)[1];t&&p.includes(n)&&n!=l&&(d(n),I(n))}),[t,p]);var D=function(e){if(!t)return"";var n=t.getBounds().toArray(),o=Object(a.a)(n,2),i=Object(a.a)(o[0],2),c=i[0],r=i[1],l=Object(a.a)(o[1],2),s=l[0],d=l[1];return"https://api3.geo.admin.ch/rest/services/api/MapServer/identify?geometryType=esriGeometryEnvelope&geometry=".concat(c,",").concat(r,",").concat(s,",").concat(d,"&imageDisplay=500,600,96&mapExtent=").concat(c,",").concat(r,",").concat(s,",").concat(d,"&tolerance=1&layers=all:").concat(e,"&sr=4326&geometryFormat=geojson")},I=function(e){console.log("layer",e),console.log("queryUrl()",D(e)),g("loading..."),B(null),x.a.get(D(e)).then((function(e){e.data.results.length>0?g("Loaded ".concat(e.data.results.length," features.")):g("Found no features."),t.getSource("my-overlay")?t.getSource("my-overlay").setData({type:"FeatureCollection",features:e.data.results}):(t.addSource("my-overlay",{type:"geojson",data:{type:"FeatureCollection",features:e.data.results}}),t.addLayer({filter:["==","$type","Polygon"],id:"my-overlay-fill",source:"my-overlay",type:"fill",paint:{"fill-color":"#3498db","fill-opacity":.5}}),t.addLayer({id:"my-overlay-line",source:"my-overlay",type:"line",paint:{"line-color":"#2980b9","line-width":2,"line-opacity":.5}}),t.addLayer({filter:["==","$type","LineString"],id:"my-overlay-linestring",source:"my-overlay",type:"line",paint:{"line-color":"#2980b9","line-width":2,"line-opacity":.8}}),t.addLayer({filter:["==","$type","LineString"],id:"my-overlay-linestring-clickregion",source:"my-overlay",type:"line",paint:{"line-color":"#2980b9","line-width":20,"line-opacity":0}}),t.addLayer({filter:["==","$type","Point"],id:"my-overlay-point",source:"my-overlay",type:"circle",paint:{"circle-radius":8,"circle-color":"#2980b9","circle-opacity":.5}}),t.on("click","my-overlay-fill",(function(e){B(e.features[0].properties)})),t.on("click","my-overlay-line",(function(e){B(e.features[0].properties)})),t.on("click","my-overlay-linestring-clickregion",(function(e){B(e.features[0].properties)})),t.on("click","my-overlay-point",(function(e){B(e.features[0].properties)})))})).catch((function(e){g("Error loading features.")}))};return Object(o.useEffect)((function(){if("loading..."!=l){var e=window.location.hash.split("/"),t=Object(a.a)(e,5),n=t[2],o=t[3],i=t[4],c="#/".concat(l,"/").concat(n,"/").concat(o,"/").concat(i,"/");window.history.replaceState(void 0,void 0,c)}}),[l]),Object(O.jsxs)("div",{style:{position:"absolute",left:0,top:0},children:[Object(O.jsxs)(y.a,{m:1,p:1,children:[Object(O.jsx)(S.a,{children:Object(O.jsx)(y.a,{m:1,p:1,children:Object(O.jsx)(F.a,{id:"autocomplete",value:l,options:p,getOptionLabel:function(e){return e},style:{minWidth:300},onChange:function(e,t){return d(t)},renderInput:function(e){return Object(O.jsx)(z.a,Object(v.a)(Object(v.a)({},e),{},{label:"Select layer",variant:"outlined"}))}})})}),Object(O.jsxs)(y.a,{my:1,display:"flex",flexDirection:"row",children:[Object(O.jsx)(y.a,{children:Object(O.jsx)(w.a,{variant:"contained",color:"primary",onClick:function(){return I(l)},children:"Show"})}),Object(O.jsx)(y.a,{mx:1,children:Object(O.jsx)(w.a,{variant:"contained",color:"primary",onClick:function(){window.open(D(l))},children:"GeoJSON"})})]}),Z&&Object(O.jsx)(S.a,{children:Object(O.jsxs)(y.a,{m:1,p:1,children:[Object(O.jsx)(s.a,{onClick:function(){return B(null)},children:Object(O.jsx)(H.a,{})}),Object(O.jsx)(y.a,{style:{width:Math.min(.75*i,340),maxHeight:.5*n,overflow:"auto"},children:Object(O.jsx)(k.a,{children:Object.keys(Z).map((function(e,t){return Object(O.jsx)(C.a,{children:Object(O.jsx)(L.a,{primary:Z[e],secondary:e})},t)}))})})]})})]}),Object(O.jsx)(W.a,{open:Boolean(m),autoHideDuration:5e3,onClose:function(){return g(null)},message:m,anchorOrigin:{vertical:"top",horizontal:"center"},action:Object(O.jsx)(s.a,{color:"inherit",onClick:function(){return g(null)},children:Object(O.jsx)(H.a,{})})})]})},Z=function(){var e=Object(o.useState)(window.innerHeight),t=Object(a.a)(e,2),n=t[0],i=t[1],c=Object(o.useState)(window.innerWidth),r=Object(a.a)(c,2),l=r[0],s=r[1],d=Object(o.useState)(null),u=Object(a.a)(d,2),j=u[0],p=u[1];return Object(o.useEffect)((function(){var e=function(){i(window.innerHeight),s(document.getElementById("root").clientWidth)};return window.addEventListener("resize",e),e(),function(){return window.removeEventListener("resize",e)}}),[]),Object(O.jsxs)("div",{children:[Object(O.jsx)(m,{viewportWidth:l,viewportHeight:n,centerLongitude:8,centerLatitude:47,shareMap:p}),Object(O.jsx)(M,{map:j,viewportHeight:n,viewportWidth:l})]})};c.a.render(Object(O.jsx)(Z,{}),document.getElementById("root"))}},[[125,1,2]]]);
//# sourceMappingURL=main.57182af0.chunk.js.map